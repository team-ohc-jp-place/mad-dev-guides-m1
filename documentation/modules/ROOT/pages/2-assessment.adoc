= 2. アセスメント(評価) – 25分
:imagesdir: ../assets/images

== 本演習の目標

Globexにおけるデジタルトランスフォーメーションおよびクラウド導入にあたっての取り組みの一環として、開発チームとDevOpsチームは Red Hat Virtualization上の仮想マシン上で動作しているサイロ化した既存サービスと、Red Hat OpenShift上のコンテナ化されたアプリケーションを個別にモダナイゼーションへ向けて対応することとしました。

本演習の目標は、アプリケーションモダナイゼーションのために高度なクラウドネイティブアーキテクチャの実装を行うために、既存アプリケーションのポートフォリオを評価して潜在する問題やリスクを特定することです。

== 2.1. MTA Web Consoleへのアクセス

既存アプリケーションの評価を実施するために、 https://access.redhat.com/documentation/en-us/migration_toolkit_for_applications/6.0/html-single/introduction_to_the_migration_toolkit_for_applications/index[Migration Toolkit for Applications (MTA)^] を使用します。本演習では、 _MTA_ を使用して、Red Hat Virtualization上のTomcatサーバーで動作する `Customers` サービスを評価します。

新たにブラウザを開き、 https://mta-mta-%USERID%.%SUBDOMAIN%[MTA Web Console^] にアクセスします。

アクセス後、 *Customers*、 *Orders*、 *Inventory* など、既存アプリケーションのインベントリ情報が表示されます。

image::application-inventory.png[application inventory]

**MTAのApplication Inventory** では、 https://github.com/konveyor/tackle-pathfinder[Tackle Pathfinder^] による評価と https://github.com/windup/[Windup^] による解析を行いたい対象のアプリケーションを選択します。ここには主に以下4つの機能があります。

* アプリケーションのポートフォリオの維持
* アプリケーションと、それをサポートするビジネスサービスのリンク
* 相互依存関係の定義付け
* アプリケーションを多次元での記述や分類をするための拡張可能なタグ付けモデルを使用したメタデータの追加

**Tackle Pathfinder** は、エンタープライズ Kubernetesプラットフォーム上のコンテナにデプロイするために使用できる、アプリケーションのモダナイゼーションに対する適性を評価する対話型アンケートベースのツールです。このツールでの出力内容には以下が含まれます。

* アプリケーションのコンテナ化およびKubernetesへの適合性
* 関連するリスクの優先順位リスト（ツールからのアンケートに対する回答に基づいています）
* アプリケーションの優先順位、ビジネスクリティカル、依存関係が記載された実行計画

Migration Waves management is a small collection of workloads that deliver business value. MTA’s Migration Wave groups applications to be migrated on a specified schedule. In addition, a migration wave enables you to export a list of the wave’s applications to the Jira issue management system. This automatically creates a separate Jira issue for each application of the migration wave for tracking.

For more information, see Creating migration waves and Creating Jira issues for a migration wave.

== 2.2. Controls

*Controls* は、Application InventoryおよびPathfinderの評価に付加価値を加えるエンティティの集合体です。これは、 _business services_、 _stakeholders_、 _stakeholder groups_、 _job functions_、 _tag types_、 _tags_ で構成されています。

Controlは、アプリケーションとそのビジネスにおけるステークホルダーとの関係性に関する有用なメタデータを含み、ポートフォリオ全体のモダナイゼーション計画を最適化する際にご活用いただけます。

=== 2.2.1. ステークホルダー

左メニューの `Controls` に進むと、 *Hank Scorpio* や *Homer Simpson* といった既存のステークホルダーが表示されます。

image::mta-control-stakeholder.png[stakeholders]

また、アプリケーションの評価のために *IT Management* や *Retail Management* など、既存の _ステークホルダーのグループ_ を確認できます。

image::mta-stakeholder-groups.png[stakeholder-groups]

=== 2.2.2. Business services

アプリケーションは **business service** などの複数の方法で分類やグループ化できます。すでにレガシーな `Retail` アプリケーション向けのBusiness serviceを作成してあります。

左メニューの `Controls` から _Business services_ タブをクリックすると、 *Finance and HR*、 *Retail* など、既存の _business services_ が表示されます。

image::mta-control-business-service.png[business service]

== 2.3. Application inventory

続いて、レガシーアプリケーションに焦点をあててみます。 `Java` や `Tomcat`、 `Oracle` などの、どのテクノロジーかを表し、各アプリケーションがどのカスタムアーキテクチャライブラリを使用しているかを識別できるカスタムタグタイプが既に追加されています。

=== 2.3.1. 「Customers」のApplication Inventoryの確認

左メニューの `Application inventory` から、「Customers」のインベントリに対する `鉛筆` （EDIT）アイコンをクリックしてください。

image::app-inventory-landing.png[app-inventory-landing]

`Tags` にある `2 more` ボタンクリックすると、以下5つのタグが表示されます。

* Oracle
* Java
* Tomcat
* Corporate Custom Configuration Library
* RHEL 8

「Cancel」をクリックしてください。

=== 2.3.2. レガシーアプリケーション「Customers」へのアクセス

評価はアンケートによって進められ、アプリケーションごとにコンテナ化の適否を判断することを目的としています。 *テクノロジー*、 *アプリケーションライフサイクルマネジメント*、 *運用* などを含む、 *アプリケーションランドスケープ* のさまざまな領域をすべてカバーしています。このアンケートによって、コンテナでのアプリケーションの実行を妨げる可能性のある潜在的なリスクや、リスクを軽減するための特別な対応が必要な事項を、ツールが特定し提示します。

あるステークホルダーチームでは、技術的な問題を特定するために、すでに `retail` サービスに対する評価を実施しています。しかしながら、初回の評価では設定ファイルの運用方法の質問に対して回答できませんでした。そのため、その時点では、回答を `Unknown` としていました。

これから「Customers」アプリケーション向けの `cross-cutting concerns` のセクションで適切な回答が選択できるように、 *2回目* の評価を実施します。

`Customers` アプリケーションを選択して `Assess` をクリックしてください。

image::app-inventory-access.png[app-inventory-access]

*「This application has already been assessed. Do you want to continue?」* というメッセージが表示された場合、 `Continue` をクリックして評価を続行します。

image::edit-assessment.png[edit-assessment]

まず初めに、評価に関係するステークホルダー（ _Homer Simpson_ ）とステークホルダーグループ（ _Retail Management_ ）を選定します。初期値のまま進めてください。

image::select-stakeholder.png[select-stakeholder]

`Next` をクリックしてください。

[NOTE]
====
`Details`、 `Dependencies`、 `Observability` などのアプリケーションアセスメント項目ごとに、初期アセスメントでの旧回答を確認します。回答を変更する必要はありませんが、「アプリケーション横断的な懸念事項(Application cross-cutting concerns)」セクションに入るまで、 `Next` ボタンをクリックし続けてください。
====

image::app-details.png[app-details]

=== 2.3.3. アプリケーションの横断的な懸念事項

*「How is the application configured?」* という質問に対して、以下回答を選択してください。このチームは、「Customers」アプリケーションが現状、複数の設定ファイルが異なるフォルダ/ディレクトリに存在していることを突き止めたので、その状況を回答します。

* *Question* - How is the application configured?
* *Answer* - `Multiple configuration files in multiple file system locations`

image::app-cross-cutting-concerns.png[app-cross-cutting-concerns]

「Save and review」をクリックしてください。

== 2.4. アプリケーションの確認

「Save」をクリック後、レビュー画面が表示されます。この画面では、アセスメントにおいてどのようなリスクが含まれているかを確認でき、そのリスクに基づいてどのような移行戦略をとるかの意志決定ができます。

image::review.png[review]

画面を下にスクロールすると、該当するリスクが表示されます。このレガシーアプリケーションは、クラウドに向かないスタティック（固定）ディスカバリーメカニズムを使用しています。これは、古典的なプラットフォームに由来しており、 *固定IP* を介してデータベースにアクセスするという当然のことを行っております。

image::review-high-risk.png[review-high-risk]

アプリケーションをクラウドに適応させるには、ソースコードの変更が必要であることが判明したため、その戦略を `Refactor` とします。

* Proposed action: `Refactor`
* Effort estimate: `Small`

このアーキテクチャの中で重要なアプリケーションに対する対応のため、重要度を `10`、優先度を `9` に設定します。

* Business criticality: `10`
* Work priority: `9`

設定後、「Submit Review」をクリックしてください。

image::submit-review.png[submit-review]

この時点で、 `アプリケーションの横断的な懸念事項` セクションを更新して2回目の評価が完了しています。また、外部設定への参照や依存関係といった新たな高リスクも特定されました。

image::complete-review.png[complete-review]

左メニューの `Report` をクリックしてください。クリックすると _Current landscape_、 _Adoption candidate distribution_、 _Suggested adoption plan_、 _Identified risks_ などの `レポート` の詳細を確認できます。

image::report-review.png[report-review]

== おめでとうございます！

以上で、現在のアプリケーションのポートフォリオを評価することでモダナイゼーションへ向けたプロセスを無事に開始し、次のステップ「モダナイゼーションの一環としてアプリケーション分析とコード修正の実施」にて検討するべき問題やリスクの特定が完了しました。

ユースケースとマイグレーションパスについての詳細は、 https://developers.redhat.com/products/mta/use-cases[Migration Toolkit for Applications^]を参照ください。
